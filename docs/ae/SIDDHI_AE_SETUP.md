# TPS Siddhi AE

The Transparent Security TPS AE is an implementation of transparent security
analytics engine based on Siddhi. It is able to identify a DDoS attack in about
1 second by examining telemetry reports generated by a switch or router. This
will also identify when a mitigated attack has ended based on drop telemetry reports
from the SDN controller.

The directions below are how to run this as a simple Java program (as with our
"lab_trial" scenario tests), but these scripts can also be deployed to any
Siddhi compliant engine containing our UDP & P4-TRPT extensions (and a running
Kafka instance). Additionally, Siddhi scripts can also be converted to run in
Kubernetes where the siddhi-operator has been installed.

## Host Software Requirements

1. Java 8+
1. git
1. maven
1. kafka

## Setup and run

There are several methods that can be used to run Siddhi scripts.

### Java application

- Install Java 8+ (CI is running OpenJDK 11.0.11)
- Install Git client (apt install git)
- Install Maven client (apt install maven)
- Install and start Kafka to port 9092 (
  see https://www.digitalocean.com/community/tutorials/how-to-install-apache-kafka-on-ubuntu-20-04)
- Clone the following Git
  project: https://github.com/cablelabs/siddhi-map-p4-trpt.git
- Open shell to the cloned directory (e.g. cd ~/siddhi-map-p4-trpt)
- Execute

```bash
cd {siddhi-map-p4-trpt directory}
mvn exec:java -Dexec.mainClass=io.siddhi.extension.map.p4.StartSiddhiRuntime \
-Dexec.args="{siddhi-script-location} {siddhi-script-location} ..." -f pom.xml
```

### Kubernetes
Other than a Siddhi runtime server or Java application, another means to deploy
Siddhi scripts is on Kubernetes with the
[siddhi-operator](https://github.com/siddhi-io/siddhi-operator).

- Install siddhi-operator
- Apply CRDs
  - kafka-operator.yml
  - parse-trpt-udp.yml
  - eval-pkt-trpt.yml
  - eval-drop-trpt.yml
